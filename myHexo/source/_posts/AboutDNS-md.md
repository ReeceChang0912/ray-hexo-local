---
title: DNS
thumbnail: https://w.wallhaven.cc/full/8x/wallhaven-8xo2x1.jpg
date: 2022-04-20 17:01:04
tags:
categories: 
  - - 技术博客
---
## 缘起
我之所以会对DNS产生疑问，主要因为最近我的之前购买的服务器快要到期了，我不得不迁移我的博客，因为继续使用的费用变得十分昂贵。
索性有github，这个yyds，git.io轻松帮助你不知博客，后面我重新购买了一个域名来解析到gitio，但是我尝试了好久，A类地址，C类地址，都弄了半天，就是没成功，最后居然是开了https才成功。那么我这是就以已经对dns与cdn产生了很大的兴趣，之前也学习过，但是忘的差不多了，今天再次学习一下。

### 一个问题
前端有一个经典的面试题，输入URL到页面展示的过程经历了什么？
这里重点说一下这个DNS的问题。
首先先去浏览器缓存查看（chrome），如果没有，去看本机的host文件，如果没有，再去本地的DNS服务器看，我们连接校园网都会去配置的那个东西找，如果没有，再像外部继续找，那么外部在哪？
对我们而言，外部就是网络运营商提供的，中国移动，中国联通等。
那么怎么连接到外部？
很简单，会通过操作系统的例如，Linux GNU glibc标准库的gethostbyname函数)，调用网卡发送UDP包去请求ip地址。

### 关于DNS服务器
先说说域名系统，我们应该从右往左看例如：www.example.com.
依次是
1. 根域名. 
2. 顶级域名 com 
3. 次级域名 example 次级域名可以在域名网站上购买
4. 主机名 又叫作三级域名 就是www

我们查找的时候也是从上往下一层层查找，全球有13个根域名服务器，10个放在美国，一个主，9个从，其他分别英国，瑞典和日本。那么是不是说我们访问都要先访问美国的根域名服务器呢？
答案是不是，我们的运营商服务器就搞了一些镜像，我们访问镜像就可。

### 再说说CDN 
 麻省理工学院的成就之一，应用数学的教授发明了这个东西。
 主要思路就是部署多个从服务器，缓存源主机的东西，例如视频，html等，而且是只能的缓存，不是全部copy，比如很常用的长时间缓存。
 这样，一个域名可能就对应了很多个ip地址，我们首先访问CDN服务器，拿到全部的CDN列表，然后访问负载均衡服务器，确定访问的具体的分布的那一个CDN服务器，然后访问具体的分布服务器。


